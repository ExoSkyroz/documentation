var Thelpers={},Tangular={};Tangular.register=function(n,e){Thelpers[n]=e},Tangular.compile=function(n){n||(n="");for(var e=-1,r=[],i=-1,s=0,t=n.length,u=0;t>e++;){var a=n.substring(e,e+2);if(-1===i)if("{{"!==a);else{if(-1!==i){u++;continue}var l=n.substring(s,e);r.push(l?'unescape("'+escape(l)+'")':'""'),i=e+2}else if("}}"===a){if(u>0){u--;continue}r.push(n.substring(i,e).trim()),s=e+2,i=-1;continue}}r.push('unescape("'+escape(n.substring(s,t))+'")'),t=r.length;for(var g="$output+=",f='var $s=this;var $output="";',o=[],p=!1,c=0,h=0;t>h;h++)if(h%2!==0){var d=r[h],v=!1,e=d.lastIndexOf("|"),b="helpers.encode(@)",T=null,$=d.substring(0,3);"if "===$&&(d="if( "+d.substring(3)+"){",v=!0),"foreach "===d.substring(0,8)&&(T=d.split(" "),"var"===T[1]&&T.splice(1,1),o.push(T[1]),v=!0,p=!0,c++);var m=d.substring(0,5);if("endif"===m?(d="}",v=!0):"else"===m?(d="} else {",v=!0):("end"===$||"endfor"===d.substring(0,6))&&(d=0===o.length?"}":"}})();",o.pop(),v=!0,c--,0===c&&(p=!1)),v)d=Tangular.append(d,o,p).trim();else{if(-1!==e){b=d.substring(e+1).trim(),d=d.substring(0,e),e=b.indexOf("(");var x=b;if(-1===e?b+="(@)":(x=b.substring(0,e),b=b.substring(0,e+1)+"@"+(-1===b.indexOf("()")?",":"")+b.substring(e+1)),b="helpers."+b,void 0===Thelpers[x])throw new Error('Helper: "'+x+'" not found.')}e=b.indexOf("("),b=b.substring(0,e)+".call($s,"+b.substring(e+1),d=b.replace("@",Tangular.append(d,o,p).trim())}if(v){if(T){var w=Tangular.append(T[3],o,p);d="if ("+w+"===null||"+w+"===undefined)"+w+"=[];(function(){for(var i=0,length="+w+".length;i<length;i++){var "+T[1]+"="+w+"[i];var $index=i;"}f+=d}else f+=g+d+";"}else f+=g+r[h]+";";return function(n){return new Function("helpers",f+";return $output;").call(n,Thelpers)}},Tangular.append=function(n,e,r){var i=[],s=n.split(" ");void 0===e&&(e=[]);for(var t=e.length,u=0,a=s.length;a>u;u++){var l=s[u],g=l.charCodeAt(0);if(g>64&&91>g||g>96&&123>g||36===g||95===g||33===g){var f=l.substring(0,5);if("if"===l.substring(0,2)||"endif"===f||"else"===f||"endfor"===l.substring(0,6)||"foreach"===l.substring(0,7)){i.push(l);continue}var o="!"===l.substring(0,1),p=!1;o&&(l=l.substring(1));for(var c=0;t>c;c++)if(l.substring(0,e[c].length)===e[c]){p=!0;break}if(p){i.push((o?"!":"")+l);continue}if(r&&null!==l.match(/^\$index(\s|$)/g)){i.push((o?"!":"")+l);continue}i.push((o?"!":"")+"$s."+l)}else i.push(l)}return i.join(" ")},Tangular.render=function(n,e){return(void 0===e||null===e)&&(e={}),"string"==typeof n&&(n=Tangular.compile(n)),n(e)},Tangular.register("encode",function(n){return(void 0===n||null===n)&&(n=""),n.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),Tangular.register("raw",function(n){return(void 0===n||null===n)&&(n=""),n});